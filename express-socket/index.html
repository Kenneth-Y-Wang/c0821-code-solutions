<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Socket.io Example</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.2.0/socket.io.js"></script>
</head>

<body>
  <h1>Our Socket.io Chat Application</h1>
  <div>
    <h2>Messages</h2>
    <ul></ul>
  </div>
  <form action="">
    <input type="text" />
    <button>Send</button>
  </form>
  <!-- <script src="/socket.io/socket.io.js"></script> -->
  <script>
    const form = document.querySelector('form');
    const input = document.querySelector('input');
    const messageList = document.querySelector('ul');

    const socket = io('/');
    socket.on('connection');

    function sendMessage(e) {
      // prevent form submission refreshing page
      e.preventDefault();
      // send input value to server as type 'message'
      socket.emit('message', input.value);
      // reset input value
      input.value = '';
    }

    form.addEventListener('submit', sendMessage);

    function addMessageToHTML(message) {
      // create a new li element
      const li = document.createElement('li');
      // add message to the elements text
      li.innerText = message;
      // add to list of messages
      messageList.append(li);
    }
    // watch for socket to emit a 'message'
    socket.on('message', addMessageToHTML);

    function alertUserConnected() {
      addMessageToHTML('User connected');
    }
    // watch for socket to emit a 'user connected' event
    socket.on('user connected', alertUserConnected);
  </script>
</body>

</html>
